{% extends "base.html" %}
{% load widget_tweaks %}

{% block title %}Login — PharmaCare{% endblock %}

{% block content %}
<div class="min-vh-100 d-flex align-items-center justify-content-center py-1" 
     style="background: linear-gradient(135deg, #f5fffd 0%, #e8f7f5 100%);">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-12 col-md-8 col-lg-6 col-xl-5">

        <!-- Login Card -->
        <div class="card border-0 shadow-lg rounded-4 overflow-hidden">
          <!-- Header with Teal Gradient -->
          <div class="text-white text-center py-5 px-4" 
               style="background: linear-gradient(135deg, var(--pharma-teal), var(--pharma-teal-dark));">
            <i class="bi bi-capsule-pill fs-1 mb-3 text-white d-block opacity-100"></i>
            <h2 class="fw-bold mb-2 text-white">Welcome Back</h2>
            <p class="mb-0 opacity-90">Sign in to your PharmaCare account</p>
          </div>

          <div class="card-body p-4 p-lg-5">

            <!-- Non-field errors -->
            {% if form.non_field_errors %}
              <div class="alert alert-danger rounded-3 border-0 mb-4">
                <i class="bi bi-exclamation-triangle-fill me-2"></i>
                {{ form.non_field_errors|join:" " }}
              </div>
            {% endif %}

            <form method="POST" novalidate>
              {% csrf_token %}

              <!-- Username / Email -->
              <div class="mb-4">
                <label class="form-label fw-semibold text-dark">
                  <i class="bi bi-person-circle me-2 text-primary"></i>
                  {{ form.username.label }}
                </label>
                {{ form.username|add_class:"form-control form-control-lg rounded-3 shadow-sm"|attr:"placeholder:Enter username or email" }}
                {% for error in form.username.errors %}
                  <small class="text-danger mt-1 d-block"><i class="bi bi-exclamation-circle-fill me-1"></i>{{ error }}</small>
                {% endfor %}
              </div>

              <!-- Password -->
              <div class="mb-4 position-relative">
                <label class="form-label fw-semibold text-dark">
                  <i class="bi bi-lock-fill me-2 text-primary"></i>
                  {{ form.password.label }}
                </label>
                {{ form.password|add_class:"form-control form-control-lg rounded-3 shadow-sm pe-5"|attr:"placeholder:Enter your password" }}
                
                

                {% for error in form.password.errors %}
                  <small class="text-danger mt-1 d-block"><i class="bi bi-exclamation-circle-fill me-1"></i>{{ error }}</small>
                {% endfor %}
              </div>

              <!-- Remember + Forgot -->
              <div class="d-flex justify-content-between align-items-center mb-4">
              
                <a href="{% url 'password_reset' %}" 
                   class="small fw-medium text-primary text-decoration-none hover-underline">
                  Forgot password?
                </a>
              </div>

              <!-- Submit Button -->
              <div class="d-grid mb-4">
                <button type="submit" 
                        class="btn btn-primary btn-lg fw-bold rounded-3 shadow-sm py-3">
                  <i class="bi bi-box-arrow-in-right me-2"></i> Sign In
                </button>
              </div>

              <!-- CAPTCHA if present -->
              {% if form.captcha %}
                <div class="mb-4">
                  {{ form.captcha }}
                  {% for error in form.captcha.errors %}
                    <small class="text-danger d-block"><i class="bi bi-exclamation-circle-fill me-1"></i>{{ error }}</small>
                  {% endfor %}
                </div>
              {% endif %}
            </form>

            <!-- Register Link -->
            <div class="text-center pt-3 border-top">
              <p class="text-muted mb-0">
                New to PharmaCare? 
                <a href="{% url 'register' %}" class="fw-bold text-primary text-decoration-none">
                  Create an account
                </a>
              </p>
            </div>
          </div>
        </div>

        <!-- Small trust footer -->
        <div class="text-center mt-4 text-muted small">
          <i class="bi bi-shield-check text-success me-1"></i>
          Your data is encrypted and protected • Licensed pharmacy platform
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .hover-underline:hover { text-decoration: underline !important; }
  
  /* Subtle focus glow */
  .form-control:focus {
    border-color: var(--pharma-teal);
    box-shadow: 0 0 0 0.25rem rgba(43, 138, 126, 0.15);
  }
</style>
{% endblock %}